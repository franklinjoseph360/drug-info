{"version":3,"file":"main.js","mappings":"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","sources":["external commonjs \"@nestjs/core\"","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/app.module.ts","external commonjs \"tslib\"","external commonjs \"@nestjs/common\"","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/drugs/drugs.module.ts","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/drugs/drugs.controller.ts","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/drugs/drugs.service.ts","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/prisma/prisma.service.ts","external commonjs \"@prisma/client\"","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/drugs/dto/get-drugs-query.dto.ts","external commonjs \"class-validator\"","external commonjs \"class-transformer\"","/Users/franklinjoseph/React/drug-info/apps/backend/src/app/prisma/prisma.module.ts","webpack/bootstrap","/Users/franklinjoseph/React/drug-info/apps/backend/src/main.ts"],"sourcesContent":["module.exports = require(\"@nestjs/core\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AppModule = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst drugs_module_1 = require(\"./drugs/drugs.module\");\nconst prisma_module_1 = require(\"./prisma/prisma.module\");\nlet AppModule = class AppModule {\n};\nexports.AppModule = AppModule;\nexports.AppModule = AppModule = tslib_1.__decorate([\n    (0, common_1.Module)({\n        imports: [prisma_module_1.PrismaModule, drugs_module_1.DrugsModule],\n    })\n], AppModule);\n","module.exports = require(\"tslib\");","module.exports = require(\"@nestjs/common\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DrugsModule = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst drugs_controller_1 = require(\"./drugs.controller\");\nconst drugs_service_1 = require(\"./drugs.service\");\nconst prisma_module_1 = require(\"../prisma/prisma.module\");\nlet DrugsModule = class DrugsModule {\n};\nexports.DrugsModule = DrugsModule;\nexports.DrugsModule = DrugsModule = tslib_1.__decorate([\n    (0, common_1.Module)({\n        imports: [prisma_module_1.PrismaModule],\n        controllers: [drugs_controller_1.DrugsController],\n        providers: [drugs_service_1.DrugsService],\n    })\n], DrugsModule);\n","\"use strict\";\nvar _a, _b;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DrugsController = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst drugs_service_1 = require(\"./drugs.service\");\nconst get_drugs_query_dto_1 = require(\"./dto/get-drugs-query.dto\");\nlet DrugsController = class DrugsController {\n    constructor(service) {\n        this.service = service;\n    }\n    // GET /api/table-config - simple route provided here for convenience\n    getTableConfig() {\n        return this.service.getTableConfig();\n    }\n    // GET /api/drugs\n    async findAll(query) {\n        return this.service.findAll(query);\n    }\n};\nexports.DrugsController = DrugsController;\ntslib_1.__decorate([\n    (0, common_1.Get)('/table-config'),\n    tslib_1.__metadata(\"design:type\", Function),\n    tslib_1.__metadata(\"design:paramtypes\", []),\n    tslib_1.__metadata(\"design:returntype\", void 0)\n], DrugsController.prototype, \"getTableConfig\", null);\ntslib_1.__decorate([\n    (0, common_1.Get)(),\n    tslib_1.__param(0, (0, common_1.Query)()),\n    tslib_1.__metadata(\"design:type\", Function),\n    tslib_1.__metadata(\"design:paramtypes\", [typeof (_b = typeof get_drugs_query_dto_1.GetDrugsQueryDto !== \"undefined\" && get_drugs_query_dto_1.GetDrugsQueryDto) === \"function\" ? _b : Object]),\n    tslib_1.__metadata(\"design:returntype\", Promise)\n], DrugsController.prototype, \"findAll\", null);\nexports.DrugsController = DrugsController = tslib_1.__decorate([\n    (0, common_1.Controller)('drugs'),\n    tslib_1.__metadata(\"design:paramtypes\", [typeof (_a = typeof drugs_service_1.DrugsService !== \"undefined\" && drugs_service_1.DrugsService) === \"function\" ? _a : Object])\n], DrugsController);\n","\"use strict\";\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DrugsService = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst prisma_service_1 = require(\"../prisma/prisma.service\");\nlet DrugsService = class DrugsService {\n    constructor(prisma) {\n        this.prisma = prisma;\n    }\n    getTableConfig() {\n        return {\n            columns: [\n                { key: 'id', label: 'Id', visible: true },\n                { key: 'code', label: 'Code', visible: true },\n                { key: 'name', label: 'Name', visible: true },\n                { key: 'company', label: 'Company', visible: true },\n                { key: 'launchDate', label: 'Launch Date', visible: true },\n            ],\n        };\n    }\n    async findAll(query) {\n        const page = query.page ?? 1;\n        const limit = query.limit ?? 20;\n        const skip = (page - 1) * limit;\n        const where = {};\n        // Search\n        if (query.search) {\n            const s = query.search.trim();\n            where.OR = [\n                { brandName: { contains: s, mode: 'insensitive' } },\n                { genericName: { contains: s, mode: 'insensitive' } },\n                { code: { contains: s, mode: 'insensitive' } },\n            ];\n        }\n        // Company filter\n        if (query.company) {\n            where.company = {\n                is: {\n                    name: { equals: query.company, mode: 'insensitive' },\n                },\n            };\n        }\n        const [total, data, companies] = await Promise.all([\n            this.prisma.drug.count({ where }),\n            this.prisma.drug.findMany({\n                where,\n                orderBy: { launchDate: 'desc' },\n                skip,\n                take: limit,\n                select: {\n                    id: true,\n                    code: true,\n                    genericName: true,\n                    brandName: true,\n                    launchDate: true,\n                    company: {\n                        select: { name: true },\n                    },\n                },\n            }),\n            this.prisma.company.findMany({\n                select: { name: true },\n                orderBy: { name: 'asc' },\n            }),\n        ]);\n        const companyList = companies.map(c => c.name);\n        const mapped = data.map(d => ({\n            id: d.id,\n            code: d.code,\n            name: `${d.genericName}${d.brandName ? ` (${d.brandName})` : ''}`,\n            company: d.company?.name ?? null,\n            launchDate: d.launchDate,\n        }));\n        return {\n            data: mapped,\n            companies: companyList,\n            pagination: {\n                page,\n                limit,\n                total,\n            },\n        };\n    }\n};\nexports.DrugsService = DrugsService;\nexports.DrugsService = DrugsService = tslib_1.__decorate([\n    (0, common_1.Injectable)(),\n    tslib_1.__metadata(\"design:paramtypes\", [typeof (_a = typeof prisma_service_1.PrismaService !== \"undefined\" && prisma_service_1.PrismaService) === \"function\" ? _a : Object])\n], DrugsService);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PrismaService = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst client_1 = require(\"@prisma/client\");\nlet PrismaService = class PrismaService extends client_1.PrismaClient {\n    async onModuleInit() {\n        await this.$connect();\n    }\n    async enableShutdownHooks(app) {\n        this.$on('beforeExit', async () => {\n            await app.close();\n        });\n    }\n};\nexports.PrismaService = PrismaService;\nexports.PrismaService = PrismaService = tslib_1.__decorate([\n    (0, common_1.Injectable)()\n], PrismaService);\n","module.exports = require(\"@prisma/client\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.GetDrugsQueryDto = void 0;\nconst tslib_1 = require(\"tslib\");\nconst class_validator_1 = require(\"class-validator\");\nconst class_transformer_1 = require(\"class-transformer\");\nclass GetDrugsQueryDto {\n    constructor() {\n        this.page = 1;\n        this.limit = 20;\n    }\n}\nexports.GetDrugsQueryDto = GetDrugsQueryDto;\ntslib_1.__decorate([\n    (0, class_validator_1.IsOptional)(),\n    (0, class_validator_1.IsString)(),\n    tslib_1.__metadata(\"design:type\", String)\n], GetDrugsQueryDto.prototype, \"search\", void 0);\ntslib_1.__decorate([\n    (0, class_validator_1.IsOptional)(),\n    (0, class_validator_1.IsString)(),\n    tslib_1.__metadata(\"design:type\", String)\n], GetDrugsQueryDto.prototype, \"company\", void 0);\ntslib_1.__decorate([\n    (0, class_validator_1.IsOptional)(),\n    (0, class_transformer_1.Type)(() => Number),\n    (0, class_validator_1.IsInt)(),\n    (0, class_validator_1.Min)(1),\n    tslib_1.__metadata(\"design:type\", Number)\n], GetDrugsQueryDto.prototype, \"page\", void 0);\ntslib_1.__decorate([\n    (0, class_validator_1.IsOptional)(),\n    (0, class_transformer_1.Type)(() => Number),\n    (0, class_validator_1.IsInt)(),\n    (0, class_validator_1.Min)(1),\n    tslib_1.__metadata(\"design:type\", Number)\n], GetDrugsQueryDto.prototype, \"limit\", void 0);\n","module.exports = require(\"class-validator\");","module.exports = require(\"class-transformer\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PrismaModule = void 0;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst prisma_service_1 = require(\"./prisma.service\");\nlet PrismaModule = class PrismaModule {\n};\nexports.PrismaModule = PrismaModule;\nexports.PrismaModule = PrismaModule = tslib_1.__decorate([\n    (0, common_1.Global)(),\n    (0, common_1.Module)({\n        providers: [prisma_service_1.PrismaService],\n        exports: [prisma_service_1.PrismaService],\n    })\n], PrismaModule);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\n/**\n * This is not a production server yet!\n * This is only a minimal backend to get started.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst core_1 = require(\"@nestjs/core\");\nconst app_module_1 = require(\"./app/app.module\");\nconst common_1 = require(\"@nestjs/common\");\nasync function bootstrap() {\n    const app = await core_1.NestFactory.create(app_module_1.AppModule);\n    app.setGlobalPrefix('api');\n    app.useGlobalPipes(new common_1.ValidationPipe({ transform: true }));\n    await app.listen(process.env.PORT ? Number(process.env.PORT) : 3000);\n    console.log(`Server listening on http://localhost:${process.env.PORT ?? 3000}/api`);\n}\nbootstrap();\n"],"names":[],"sourceRoot":""}